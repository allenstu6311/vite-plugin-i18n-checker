---
alwaysApply: true
---
description: "æ¸¬è©¦è¦ç¯„ï¼šå®šç¾©æ¸¬è©¦æ¡ˆä¾‹çš„å‘½åã€çµæ§‹ã€é¢¨æ ¼èˆ‡çµ„ç¹”åŽŸå‰‡"
globs:
  - "test/**/*.test.ts"
---

# ðŸ§ª æ¸¬è©¦è¦ç¯„

æœ¬è¦ç¯„å®šç¾©æ­¤å°ˆæ¡ˆä¸­æ‰€æœ‰æ¸¬è©¦æ¡ˆä¾‹æ‡‰éµå¾ªçš„æ¨™æº–ï¼Œç¢ºä¿æ¸¬è©¦æ¡ˆä¾‹çš„ä¸€è‡´æ€§èˆ‡å¯ç¶­è­·æ€§ã€‚

---

# ðŸ“ æª”æ¡ˆå‘½åè¦ç¯„

## æª”æ¡ˆå‘½åæ ¼å¼
- ä½¿ç”¨ **kebab-case** å‘½åæ¸¬è©¦æª”æ¡ˆ
- æª”æ¡ˆåç¨±éœ€æ¸…æ¥šæè¿°æ¸¬è©¦ç¯„åœ
- çµ±ä¸€ä½¿ç”¨ `.test.ts` ä½œç‚ºå‰¯æª”å

### æª”æ¡ˆå‘½åç¯„ä¾‹
```
basic.test.ts           # åŸºæœ¬åŠŸèƒ½æ¸¬è©¦
nested.test.ts          # å·¢ç‹€çµæ§‹æ¸¬è©¦
complex.test.ts         # è¤‡é›œæƒ…æ³æ¸¬è©¦
edge-cases.test.ts      # é‚Šå¢ƒæƒ…æ³æ¸¬è©¦
array.test.ts           # é™£åˆ—ç›¸é—œæ¸¬è©¦
spread.test.ts          # Spread æ“ä½œæ¸¬è©¦
variables.test.ts       # è®Šæ•¸ç›¸é—œæ¸¬è©¦
```

---

# ðŸ—ï¸ æ¸¬è©¦æª”æ¡ˆçµæ§‹

## æ¨™æº–æ¸¬è©¦æª”æ¡ˆæ¨¡æ¿

```typescript
import { /* å°Žå…¥éœ€è¦æ¸¬è©¦çš„æ¨¡çµ„ */ } from '@/module/path';
import { describe, expect, it, beforeEach } from 'vitest';

/**
 * [æ¸¬è©¦å¥—ä»¶åç¨±]
 * [ç°¡è¦èªªæ˜Žæ­¤æ¸¬è©¦æª”æ¡ˆçš„ç›®çš„èˆ‡æ¶µè“‹ç¯„åœ]
 */
describe('[æ¸¬è©¦å¥—ä»¶åç¨±]', () => {
    // å¯é¸ï¼šæ¸¬è©¦å‰ç½®è¨­å®š
    beforeEach(() => {
        // åˆå§‹åŒ–è¨­å®š
    });

    it('[æ¸¬è©¦æ¡ˆä¾‹æè¿°]', () => {
        // æ¸¬è©¦å¯¦ä½œ
    });
});
```

---

# ðŸ“ æ¸¬è©¦æè¿°è¦ç¯„

## describe å‘½åè¦ç¯„
- ä½¿ç”¨ **ç¹é«”ä¸­æ–‡** æè¿°æ¸¬è©¦å¥—ä»¶
- æ ¼å¼ï¼š`[åŠŸèƒ½åç¨±] æ¸¬è©¦`
- ç¯„ä¾‹ï¼š`diff åŸºæœ¬æ¯”å°æ¸¬è©¦`ã€`extract åŸºæœ¬åŠŸèƒ½æ¸¬è©¦`

## it å‘½åè¦ç¯„
- ä½¿ç”¨ **ç¹é«”ä¸­æ–‡** æè¿°å–®å€‹æ¸¬è©¦æ¡ˆä¾‹
- æ¸…æ¥šæè¿°æ¸¬è©¦çš„é æœŸè¡Œç‚ºæˆ–æƒ…å¢ƒ
- ä½¿ç”¨å‹•è©žé–‹é ­ï¼Œæè¿°ã€Œæ‡‰è©²ã€ã€ã€Œèƒ½å¤ ã€ã€ã€Œæª¢æ¸¬ã€ç­‰è¡Œç‚º
- é‚Šå¢ƒæ¸¬è©¦ä»¥ã€Œé‚Šå¢ƒï¼šã€ç‚ºå‰ç¶´

### å‘½åç¯„ä¾‹
```typescript
it('å®Œå…¨ç›¸åŒçš„ç‰©ä»¶æ‡‰è©²è¿”å›žç©ºçµæžœ', () => { ... });
it('æª¢æ¸¬ç¼ºå°‘çš„éµå€¼', () => { ... });
it('é‚Šå¢ƒï¼šç©ºç‰©ä»¶èˆ‡ç©ºé™£åˆ—æ¯”å°', () => { ... });
it('ä¸‰å±¤å·¢ç‹€ç‰©ä»¶æ¯”å°', () => { ... });
```

---

# ðŸŽ¯ æ¸¬è©¦åˆ†é¡žè¦ç¯„

## åŸºæœ¬æ¸¬è©¦åˆ†é¡ž
æ ¹æ“šæ¸¬è©¦å…§å®¹çš„è¤‡é›œåº¦èˆ‡ç‰¹æ€§ï¼Œå°‡æ¸¬è©¦æª”æ¡ˆåˆ†é¡žå¦‚ä¸‹ï¼š

### 1. basic.test.ts
- **ç”¨é€”**ï¼šæ¸¬è©¦æ ¸å¿ƒåŠŸèƒ½çš„åŸºæœ¬æ“ä½œ
- **å…§å®¹**ï¼šæ¶µè“‹æœ€å¸¸è¦‹çš„ä½¿ç”¨æƒ…å¢ƒã€åŸºæœ¬è¼¸å…¥è¼¸å‡º
- **ç¯„ä¾‹**ï¼šåŸºæœ¬ç‰©ä»¶æ¯”å°ã€åŸºæœ¬é¡žåž‹è§£æž

### 2. nested.test.ts
- **ç”¨é€”**ï¼šæ¸¬è©¦å·¢ç‹€çµæ§‹çš„è™•ç†
- **å…§å®¹**ï¼šæ·±å±¤å·¢ç‹€ç‰©ä»¶ã€æ··åˆå·¢ç‹€çµæ§‹
- **ç¯„ä¾‹**ï¼šä¸‰å±¤å·¢ç‹€ç‰©ä»¶ã€é™£åˆ—ä¸­å·¢ç‹€ç‰©ä»¶

### 3. complex.test.ts
- **ç”¨é€”**ï¼šæ¸¬è©¦è¤‡é›œå ´æ™¯èˆ‡çµ„åˆæƒ…æ³
- **å…§å®¹**ï¼šå¤šç¨®æƒ…æ³åŒæ™‚ç™¼ç”Ÿã€è¤‡é›œé‚è¼¯æµç¨‹
- **ç¯„ä¾‹**ï¼šå¤šç¨®ç•°å¸¸é¡žåž‹çµ„åˆã€å¤§åž‹çµæ§‹è™•ç†

### 4. edge-cases.test.ts
- **ç”¨é€”**ï¼šæ¸¬è©¦é‚Šå¢ƒæƒ…æ³èˆ‡æ¥µç«¯è¼¸å…¥
- **å…§å®¹**ï¼šç©ºå€¼è™•ç†ã€ç‰¹æ®Šå­—ç¬¦ã€æ¥µç«¯æ·±åº¦/å¯¬åº¦ã€ç‰¹æ®Šåž‹åˆ¥
- **ç¯„ä¾‹**ï¼šnull/undefined è™•ç†ã€ç©ºå­—ä¸²éµå€¼ã€æ¥µæ·±å·¢ç‹€çµæ§‹

### 5. ç‰¹å®šåŠŸèƒ½æ¸¬è©¦
- **ç”¨é€”**ï¼šé‡å°ç‰¹å®šåŠŸèƒ½æˆ–ç‰¹æ€§çš„å°ˆé–€æ¸¬è©¦
- **å‘½å**ï¼šä»¥åŠŸèƒ½åç¨±å‘½åï¼ˆå¦‚ `array.test.ts`ã€`spread.test.ts`ï¼‰
- **å…§å®¹**ï¼šèšç„¦æ–¼è©²åŠŸèƒ½çš„å„ç¨®æƒ…æ³

---

# âœï¸ æ¸¬è©¦ç¨‹å¼ç¢¼é¢¨æ ¼

## è®Šæ•¸å‘½å
- ä½¿ç”¨ **camelCase** å‘½åè®Šæ•¸
- è®Šæ•¸åç¨±éœ€æ¸…æ¥šè¡¨é”å…¶ç”¨é€”
- æ¸¬è©¦è³‡æ–™ä½¿ç”¨æœ‰æ„ç¾©çš„åç¨±ï¼Œé¿å… `a`ã€`b`ã€`test` ç­‰éŽæ–¼ç°¡å–®çš„åç¨±

### è‰¯å¥½ç¯„ä¾‹
```typescript
const source = { name: 'John', age: 25 };
const target = { name: 'John', age: 25, email: 'john@example.com' };
const abnormalKeys = { missingField: AbnormalType.MISS_KEY };
```

### é¿å…ç¯„ä¾‹
```typescript
const a = { x: 1 };
const b = { x: 1, y: 2 };
```

## æ¸¬è©¦è¨»è§£
- æª”æ¡ˆé–‹é ­ä½¿ç”¨ **JSDoc è¨»è§£** èªªæ˜Žæ¸¬è©¦ç›®çš„
- è¤‡é›œæ¸¬è©¦é‚è¼¯éœ€åŠ ä¸Šè¡Œå…§è¨»è§£
- é‚Šå¢ƒæ¸¬è©¦éœ€èªªæ˜Žæ¸¬è©¦çš„ç‰¹æ®Šæ€§

### JSDoc ç¯„ä¾‹
```typescript
/**
 * diff åŸºæœ¬æ¯”å°æ¸¬è©¦
 * æ¸¬è©¦ diff å‡½æ•¸çš„åŸºæœ¬åŠŸèƒ½ï¼ŒåŒ…æ‹¬ç›¸åŒç‰©ä»¶ã€ç¼ºå°‘éµå€¼ã€é¡å¤–éµå€¼ç­‰åŸºæœ¬æƒ…æ³
 */
```

### é‚Šå¢ƒæ¸¬è©¦è¨»è§£ç¯„ä¾‹
```typescript
it('é‚Šå¢ƒï¼šç©ºç‰©ä»¶èˆ‡ç©ºé™£åˆ—æ¯”å°', () => {
    // æ¸¬è©¦ç©ºç‰©ä»¶èˆ‡ç©ºé™£åˆ—çš„é¡žåž‹å·®ç•°è™•ç†
    ...
});
```

---

# ðŸ§© æ¸¬è©¦å…§å®¹è¦ç¯„

## å¿…é ˆæ¶µè“‹çš„æ¸¬è©¦é¡žåž‹

### 1. åŸºæœ¬åŠŸèƒ½æ¸¬è©¦
- æ­£å¸¸æµç¨‹çš„é æœŸè¡Œç‚º
- æœ€å¸¸è¦‹çš„ä½¿ç”¨æƒ…å¢ƒ
- åŸºæœ¬è¼¸å…¥è¼¸å‡ºçš„æ­£ç¢ºæ€§

### 2. ç•°å¸¸æƒ…æ³æ¸¬è©¦
- ç¼ºå°‘å¿…è¦è³‡æ–™çš„è™•ç†
- é¡å¤–è³‡æ–™çš„è™•ç†
- çµæ§‹ä¸åŒ¹é…çš„è™•ç†

### 3. é‚Šå¢ƒæƒ…æ³æ¸¬è©¦
- ç©ºå€¼è™•ç†ï¼ˆnullã€undefinedã€ç©ºç‰©ä»¶ã€ç©ºé™£åˆ—ï¼‰
- ç‰¹æ®Šå­—ç¬¦éµå€¼
- æ¥µç«¯æ·±åº¦æˆ–å¯¬åº¦çš„è³‡æ–™çµæ§‹
- ç‰¹æ®Šåž‹åˆ¥ï¼ˆå‡½æ•¸ã€æ—¥æœŸã€æ­£å‰‡è¡¨é”å¼ï¼‰

### 4. å·¢ç‹€çµæ§‹æ¸¬è©¦
- å¤šå±¤å·¢ç‹€ç‰©ä»¶çš„è™•ç†
- é™£åˆ—ä¸­å·¢ç‹€ç‰©ä»¶çš„è™•ç†
- æ··åˆå·¢ç‹€çµæ§‹ï¼ˆç‰©ä»¶èˆ‡é™£åˆ—æ··åˆï¼‰

---

# ðŸ”§ æ¸¬è©¦å‰ç½®è¨­å®š

## beforeEach ä½¿ç”¨è¦ç¯„
- ç•¶æ¸¬è©¦éœ€è¦å…±ç”¨åˆå§‹åŒ–é‚è¼¯æ™‚ä½¿ç”¨ `beforeEach`
- è¨­å®šæ‡‰æ”¾åœ¨æ¸¬è©¦å¥—ä»¶çš„æœ€ä¸Šæ–¹
- åˆå§‹åŒ–é‚è¼¯éœ€æ¸…æ¥šèªªæ˜Žå…¶ç›®çš„

### ç¯„ä¾‹
```typescript
describe('processAbnormalKeys ç•°å¸¸åˆ†é¡žæ¸¬è©¦', () => {
    let abormalManager: AbnormalState;

    beforeEach(() => {
        abormalManager = createAbormalManager();
    });

    it('ç¼ºå°‘éµå€¼æ‡‰è©²æ­¸é¡žåˆ° missingKey', () => {
        // ä½¿ç”¨ abormalManager é€²è¡Œæ¸¬è©¦
    });
});
```

---

# âœ… Assertion è¦ç¯„

## ä½¿ç”¨ Vitest çš„ expect
- å„ªå…ˆä½¿ç”¨èªžæ„æ˜Žç¢ºçš„ matcher
- ä½¿ç”¨ `toEqual` é€²è¡Œæ·±åº¦æ¯”è¼ƒï¼ˆç‰©ä»¶ã€é™£åˆ—ï¼‰
- ä½¿ç”¨ `toBe` é€²è¡Œæ·ºå±¤æ¯”è¼ƒï¼ˆåŸºæœ¬åž‹åˆ¥ã€å¼•ç”¨ï¼‰
- ä½¿ç”¨ `toHaveLength` æª¢æŸ¥é™£åˆ—é•·åº¦

### ç¯„ä¾‹
```typescript
expect(result).toEqual({ a: 'hello' });           // ç‰©ä»¶æ·±åº¦æ¯”è¼ƒ
expect(array).toHaveLength(3);                    // é™£åˆ—é•·åº¦æª¢æŸ¥
expect(value).toBe(null);                          // åŸºæœ¬åž‹åˆ¥æ¯”è¼ƒ
expect(missingKey).toHaveLength(1);               // é™£åˆ—é•·åº¦æª¢æŸ¥
expect(missingKey[0]).toEqual({                    // ç‰©ä»¶æ·±åº¦æ¯”è¼ƒ
    filePaths: 'test.ts',
    key: 'missingField'
});
```

---

# ðŸ“Š æ¸¬è©¦è³‡æ–™è¦ç¯„

## æ¸¬è©¦è³‡æ–™è¨­è¨ˆåŽŸå‰‡
- æ¸¬è©¦è³‡æ–™æ‡‰å…·ä»£è¡¨æ€§ï¼Œæ¶µè“‹çœŸå¯¦ä½¿ç”¨å ´æ™¯
- ä½¿ç”¨æ¸…æ¥šå‘½åï¼Œé¿å…é­”è¡“æ•¸å­—æˆ–å­—ä¸²
- è¤‡é›œæ¸¬è©¦è³‡æ–™å¯ä½¿ç”¨è¼”åŠ©å‡½æ•¸å»ºç«‹

### è‰¯å¥½ç¯„ä¾‹
```typescript
const createDeepObject = (depth: number): any => {
    if (depth <= 0) return 'leaf';
    return {
        level: depth,
        children: createDeepObject(depth - 1)
    };
};

const source = createDeepObject(10);
```

---

# ðŸš« ç¦æ­¢äº‹é …

## é¿å…çš„åšæ³•
1. âŒ ä½¿ç”¨éŽæ–¼ç°¡å–®çš„è®Šæ•¸åç¨±ï¼ˆå¦‚ `a`ã€`b`ã€`test`ï¼‰
2. âŒ æ¸¬è©¦æè¿°ä½¿ç”¨è‹±æ–‡æ··åˆä¸­æ–‡ï¼ˆæ‡‰çµ±ä¸€ä½¿ç”¨ç¹é«”ä¸­æ–‡ï¼‰
3. âŒ ç¼ºå°‘æª”æ¡ˆé–‹é ­çš„ JSDoc è¨»è§£
4. âŒ æ¸¬è©¦é‚è¼¯éŽæ–¼è¤‡é›œï¼Œæ‡‰æ‹†åˆ†ç‚ºå¤šå€‹æ¸¬è©¦æ¡ˆä¾‹
5. âŒ åœ¨æ¸¬è©¦ä¸­ä½¿ç”¨çœŸå¯¦çš„å¤–éƒ¨è³‡æºï¼ˆæª”æ¡ˆã€ç¶²è·¯è«‹æ±‚ï¼‰
6. âŒ æ¸¬è©¦ä¹‹é–“æœ‰ä¾è³´é—œä¿‚ï¼ˆæ¯å€‹æ¸¬è©¦æ‡‰ç¨ç«‹ï¼‰

---

# ðŸ“‹ æª¢æŸ¥æ¸…å–®

åœ¨æ’°å¯«æ¸¬è©¦å‰ï¼Œè«‹ç¢ºèªï¼š

- [ ] æ¸¬è©¦æª”æ¡ˆåç¨±ä½¿ç”¨ kebab-case ä¸”ä»¥ `.test.ts` çµå°¾
- [ ] æª”æ¡ˆé–‹é ­æœ‰ JSDoc è¨»è§£èªªæ˜Žæ¸¬è©¦ç›®çš„
- [ ] `describe` å’Œ `it` çš„æè¿°ä½¿ç”¨ç¹é«”ä¸­æ–‡
- [ ] æ¸¬è©¦æ¡ˆä¾‹æ¶µè“‹åŸºæœ¬åŠŸèƒ½ã€ç•°å¸¸æƒ…æ³ã€é‚Šå¢ƒæƒ…æ³
- [ ] è®Šæ•¸å‘½åæ¸…æ¥šè¡¨é”ç”¨é€”ï¼Œä½¿ç”¨ camelCase
- [ ] ä½¿ç”¨é©ç•¶çš„ assertion matcherï¼ˆtoEqualã€toBeã€toHaveLengthï¼‰
- [ ] æ¸¬è©¦æ¡ˆä¾‹ä¹‹é–“ç›¸äº’ç¨ç«‹ï¼Œç„¡ä¾è³´é—œä¿‚
- [ ] è¤‡é›œæ¸¬è©¦é‚è¼¯æœ‰é©ç•¶è¨»è§£èªªæ˜Ž

---

# ðŸ¤– AI è¡Œç‚ºè¦ç¯„

ç•¶ AI å”åŠ©æ’°å¯«æ¸¬è©¦æ™‚ï¼Œæ‡‰éµå¾ªï¼š

1. **æ¸¬è©¦æª”æ¡ˆåˆ†é¡ž**ï¼šæ ¹æ“šæ¸¬è©¦å…§å®¹é¸æ“‡é©ç•¶çš„åˆ†é¡žï¼ˆbasicã€nestedã€complexã€edge-casesï¼‰
2. **å®Œæ•´è¦†è“‹**ï¼šç¢ºä¿æ¶µè“‹åŸºæœ¬åŠŸèƒ½ã€ç•°å¸¸æƒ…æ³ã€é‚Šå¢ƒæƒ…æ³
3. **é¢¨æ ¼ä¸€è‡´**ï¼šéµå¾ªæ—¢æœ‰çš„å‘½åèˆ‡çµæ§‹é¢¨æ ¼
4. **æ¸…æ¥šæè¿°**ï¼šæ¸¬è©¦æè¿°æ¸…æ¥šè¡¨é”æ¸¬è©¦ç›®çš„èˆ‡é æœŸè¡Œç‚º
5. **é¿å…å†—é•·**ï¼šæ¸¬è©¦é‚è¼¯ä¿æŒç°¡æ½”ï¼Œè¤‡é›œé‚è¼¯æ‹†åˆ†æˆå¤šå€‹æ¸¬è©¦æ¡ˆä¾‹